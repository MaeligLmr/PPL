(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1206,e=>{"use strict";var r=e.i(43476),t=e.i(71645),i=e.i(76525),s=e.i(49721),a=e.i(68757);let o=(0,t.forwardRef)(({label:e,error:o,fullWidth:n=!1,style:l,value:c,type:u,...d},p)=>{let[f,x]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),g=void 0!==c&&""!==c,v="password"===u;return(0,r.jsxs)("div",{className:["ui-input-container",n?"ui-input-container--full":""].join(" "),children:[e&&(0,r.jsx)("label",{className:"ui-input-label",children:e}),(0,r.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,r.jsx)("input",{ref:p,value:c,type:v&&h?"text":u,className:["ui-input",o?"ui-input--error":"",f?"ui-input--focus":"",g?"ui-input--filled":""].join(" "),style:{...l,paddingRight:v?"40px":void 0},onFocus:e=>{x(!0),d.onFocus?.(e)},onBlur:e=>{x(!1),d.onBlur?.(e)},...d}),v&&(0,r.jsx)(i.default,{type:"button",variant:"icon-plain",onClick:()=>m(!h),style:{position:"absolute",right:"5px",top:"50%",transform:"translateY(-50%)",zIndex:"100"},"aria-label":h?"Masquer le mot de passe":"Afficher le mot de passe",icon:(0,r.jsx)(s.FontAwesomeIcon,{icon:h?a.faEyeSlash:a.faEye})})]}),o&&(0,r.jsx)("span",{className:"ui-input-error",children:o})]})});o.displayName="Input",e.s(["default",0,o])},79390,e=>{"use strict";var r=e.i(17927);async function t(e,t,i){console.log("Fetching workouts for user",e,"from",t,"to",i);let{data:s,error:a}=await r.supabase.from("workout").select("*, categorie: id_category(id,nom,svg)").eq("id_user",e).order("date",{ascending:!1}).range(t,i);if(a)throw a;return s}async function i(e){console.log("Fetching workout with id",e);let{data:t,error:i}=await r.supabase.from("workout").select(`
      *,
      categorie: id_category (
        id,
        nom
      ),
      workout_line (
        *,
        exercise: id_exo (
          id,
          nom
        ),
        serie (*,
          reps(*)
        )
      )
    `).eq("id",e).single();if(i)throw i;return t}async function s(e,t,i){let{data:s,error:a}=await r.supabase.from("workout").insert([{id_user:e,date:t,id_category:i}]).select().single();if(a)throw a;return s}async function a(e){let{data:t,error:i}=await r.supabase.from("workout_line").insert([{id_workout:e,id_exo:null}]).select().single();if(i)throw i;return t}async function o(e,t){let{data:i,error:s}=await r.supabase.from("workout_line").update({id_exo:t}).eq("id",e).select().single();if(s)throw s;return i}async function n(e,t){let{data:i,error:s}=await r.supabase.from("serie").insert([{id_workout_line:e,ordre:t}]).select().single();if(s)throw s;let{data:a,error:o}=await r.supabase.from("reps").insert([{id_serie:i.id,charge:0,qte:0}]).select().single();if(o)throw o;return i}async function l(e,t,i){let{data:s,error:a}=await r.supabase.from("reps").insert([{id_serie:e,charge:t,qte:i}]).select().single();if(a)throw a;return s}async function c(e,t,i){let{data:s,error:a}=await r.supabase.from("reps").update({charge:t,qte:i}).eq("id",e).select().single();if(a)throw a;return s}async function u(e){let{data:t,error:i}=await r.supabase.from("reps").delete().eq("id",e).select().single();if(i)throw i;return t}async function d(e){let{data:t,error:i}=await r.supabase.from("workout").delete().eq("id",e).select().single();if(i)throw i;return t}async function p(e){let{data:t,error:i}=await r.supabase.from("workout_line").delete().eq("id",e).select().single();if(i)throw i;return t}async function f(e){let{data:t,error:i}=await r.supabase.from("serie").delete().eq("id",e).select().single();if(i)throw i;return t}e.s(["addExerciseToWorkout",()=>a,"addRep",()=>l,"addSet",()=>n,"createWorkout",()=>s,"deleteExercise",()=>p,"deleteRep",()=>u,"deleteSerie",()=>f,"deleteWorkout",()=>d,"editRep",()=>c,"getWorkoutById",()=>i,"getWorkoutsPaginated",()=>t,"updateWorkoutLine",()=>o])},62388,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="chevron-down",s=[],a="f078",o="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z";t.definition={prefix:"fas",iconName:i,icon:[448,512,s,a,o]},t.faChevronDown=t.definition,t.prefix="fas",t.iconName=i,t.width=448,t.height=512,t.ligatures=s,t.unicode=a,t.svgPathData=o,t.aliases=s},71120,e=>{"use strict";var r=e.i(43476),t=e.i(71645),i=e.i(49721),s=e.i(62388);let a=(0,t.forwardRef)(({label:e,error:a,fullWidth:o=!1,options:n,placeholder:l,style:c,value:u,defaultValue:d,...p},f)=>{let[x,h]=(0,t.useState)(!1),m=void 0!==u&&""!==u;return(0,r.jsxs)("div",{className:["ui-input-container",o?"ui-input-container--full":""].join(" "),children:[e&&(0,r.jsx)("label",{className:"ui-input-label",children:e}),(0,r.jsxs)("div",{className:"ui-select-wrapper",style:{position:"relative"},children:[(0,r.jsxs)("select",{ref:f,value:u,defaultValue:d,className:["ui-input",a?"ui-input--error":"",x?"ui-input--focus":"",m?"ui-input--filled":""].join(" "),style:{...c,appearance:"none",WebkitAppearance:"none",MozAppearance:"none",paddingRight:36},onFocus:e=>{h(!0),p.onFocus?.(e)},onBlur:e=>{h(!1),p.onBlur?.(e)},...p,children:[l&&(0,r.jsx)("option",{value:"",disabled:!0,hidden:!0,children:l}),n.map(e=>(0,r.jsx)("option",{value:e.value,className:"ui-select-option",children:e.label},e.value))]}),(0,r.jsx)("span",{className:"ui-select-chevron",children:(0,r.jsx)(i.FontAwesomeIcon,{icon:s.faChevronDown})})]}),a&&(0,r.jsx)("span",{className:"ui-input-error",children:a})]})});a.displayName="Select",e.s(["default",0,a])},35864,e=>{"use strict";var r=e.i(17927);async function t(e=null){if(!(await r.supabase.auth.getUser()).data.user)throw Error("Not authenticated");let i=r.supabase.from("exo").select(`
      id,
      nom,
      svg,
      exo_categorie!inner(
        categorie(
          id,
          nom
        )
      ),
      user_exo_preferences(hidden)
    `),{data:s,error:a}=await i;if(console.log("Fetched exercises:",s),a)throw a;let o=s?.filter(r=>!e||(r.exo_categorie?.flatMap(e=>e.categorie)??[]).some(r=>r?.id===e))??[];return console.log("Filtered exercises:",o),o.map(e=>{let r=e.exo_categorie?.flatMap(e=>e.categorie)??[];return{id:e.id,nom:e.nom,svg:e.svg,hidden:!!e.user_exo_preferences?.[0]?.hidden,categories:r}})}async function i(e){return(await t(e)).map(e=>({value:String(e.id),label:e.nom}))}async function s(e,t){let i=(await r.supabase.auth.getUser()).data.user;if(!i)throw Error("Not authenticated");let{error:s}=await r.supabase.from("user_exo_preferences").upsert({id_user:i.id,id_exo:e,hidden:t},{onConflict:"id_user,id_exo"});if(s)throw s}e.s(["getExercisesForSelect",()=>i,"getExercisesWithPreferences",()=>t,"toggleExerciseHidden",()=>s])},44425,e=>{"use strict";var r=e.i(43476),t=e.i(71645),i=e.i(18566),s=e.i(79390),a=e.i(60446),o=e.i(76525),n=e.i(46696);function l({isOpen:e,title:t,message:i,onConfirm:s,onCancel:a}){return e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9998},onClick:a}),(0,r.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"var(--theme-tile-bg)",border:"1px solid var(--theme-tile-border)",borderRadius:"var(--radius-15)",padding:"var(--spacing-20)",minWidth:"300px",maxWidth:"90vw",zIndex:9999,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[(0,r.jsx)("h2",{style:{margin:"0 0 var(--spacing-15) 0",color:"var(--theme-title-text)"},children:t}),(0,r.jsx)("p",{style:{margin:"0 0 var(--spacing-20) 0",color:"var(--theme-text)"},children:i}),(0,r.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-10)",justifyContent:"flex-end"},children:[(0,r.jsx)(o.default,{variant:"outlined",onClick:a,children:"Annuler"}),(0,r.jsx)(o.default,{variant:"filled",onClick:s,children:"Confirmer"})]})]})]}):null}var c=e.i(49721),u=e.i(68757),d=e.i(1206);function p({set:e,onUpdate:i,workoutId:a}){let[p,f]=(0,t.useState)(()=>{let r=localStorage.getItem(`workout_${a}_set_${e.id}_expanded`);return!!r&&JSON.parse(r)}),[x,h]=(0,t.useState)(!1),m=(e,r,t)=>{(0,s.editRep)(e,r,t)},g=async()=>{try{await (0,s.addRep)(e.id,0,0),i?.(),n.toast.success("Rep ajoutée")}catch(e){console.error("Erreur lors de l'ajout de la rep:",e),n.toast.error("Erreur lors de l'ajout de la rep")}},v=async e=>{try{await (0,s.deleteRep)(e),i?.(),n.toast.success("Rep supprimée")}catch(e){console.error("Erreur lors de la suppression de la rep:",e),n.toast.error("Erreur lors de la suppression de la rep")}},j=async()=>{try{await (0,s.deleteSerie)(e.id),i?.(),n.toast.success("Série supprimée")}catch(e){console.error("Erreur lors de la suppression de la série:",e),n.toast.error("Erreur lors de la suppression de la série")}};return(0,r.jsxs)("div",{className:"set-row",children:[(0,r.jsxs)("div",{className:"set-header",onClick:()=>{var r;f(r=!p),localStorage.setItem(`workout_${a}_set_${e.id}_expanded`,JSON.stringify(r))},children:[(0,r.jsxs)("div",{className:"set-title",children:[(0,r.jsx)(c.FontAwesomeIcon,{icon:p?u.faChevronDown:u.faChevronRight,style:{fontSize:"0.8rem"}}),(0,r.jsxs)("span",{children:["Série ",e.ordre]})]}),(0,r.jsx)(o.default,{variant:"icon-plain",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faTrash}),onClick:e=>{e.stopPropagation(),h(!0)}})]}),p&&(0,r.jsxs)("div",{className:"reps-container",children:[e.reps?.map((e,t)=>(0,r.jsxs)("div",{className:"rep-row",children:[(0,r.jsx)(d.default,{label:"Charge (kg)",type:"number",defaultValue:e.charge?.toString(),onChange:r=>m(e.id,parseFloat(r.target.value),e.qte||0),fullWidth:!0}),(0,r.jsx)(d.default,{label:"Reps",type:"number",defaultValue:e.qte?.toString(),onChange:r=>m(e.id,e.charge||0,parseInt(r.target.value)),fullWidth:!0}),(0,r.jsx)(o.default,{variant:"icon-plain",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>v(e.id)})]},e.id)),(0,r.jsx)(o.default,{variant:"plain",leftIcon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faPlus}),onClick:g,fullWidth:!0,children:"Ajouter une rep"})]}),(0,r.jsx)(l,{isOpen:x,title:"Supprimer la série",message:"Êtes-vous sûr de vouloir supprimer cette série ? Cette action est irréversible.",onConfirm:()=>{h(!1),j()},onCancel:()=>h(!1)})]})}var f=e.i(71120),x=e.i(35864);function h({exercise:e,id_category:i,isNew:a,onExerciseUpdate:d,workoutId:h}){let[m,g]=(0,t.useState)(a),[v,j]=(0,t.useState)(()=>{let r=localStorage.getItem(`workout_${h}_exercise_${e.id}_expanded`);return!!r&&JSON.parse(r)}),[w,y]=(0,t.useState)([]),[b,k]=(0,t.useState)(e.exercise?.id||null),[_,S]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(0,x.getExercisesForSelect)(i).then(r=>{y(r),e.exercise?.id&&k(e.exercise.id),a&&g(!0)})},[a,i,e.exercise?.id]);let C=async()=>{try{await (0,s.updateWorkoutLine)(e.id,b),g(!1),d?.(),n.toast.success("Exercice mis à jour")}catch(e){console.error("Erreur lors de la mise à jour de l'exercice:",e),n.toast.error("Erreur lors de la mise à jour de l'exercice")}},E=async()=>{try{let r=Math.max(0,...e.serie?.map(e=>e.ordre)||[]);await (0,s.addSet)(e.id,r+1),d?.(),n.toast.success("Série ajoutée")}catch(e){console.error("Erreur lors de l'ajout de la série:",e),n.toast.error("Erreur lors de l'ajout de la série")}},I=async()=>{try{await (0,s.deleteExercise)(e.id),d?.(),n.toast.success("Exercice supprimé")}catch(e){console.error("Erreur lors de la suppression de l'exercice:",e),n.toast.error("Erreur lors de la suppression de l'exercice")}};return(0,r.jsxs)("div",{className:"exercise-card",children:[(0,r.jsxs)("div",{className:"exercise-header",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-10)",flex:1,cursor:"pointer"},onClick:()=>{var r;j(r=!v),localStorage.setItem(`workout_${h}_exercise_${e.id}_expanded`,JSON.stringify(r))},children:[(0,r.jsx)(c.FontAwesomeIcon,{icon:v?u.faChevronDown:u.faChevronRight,style:{padding:"var(--spacing-10)",cursor:"pointer"}}),m?(0,r.jsx)(f.default,{options:[{label:"Choisir un exercice",value:""},...w],value:b||"",onChange:e=>k(e.target.value),style:{flex:1},fullWidth:!0,onClick:e=>e.stopPropagation()}):(0,r.jsx)("span",{style:{flex:1},children:e.exercise?.nom||"Nouvel exercice"})]}),m?(0,r.jsx)(o.default,{variant:"icon-outlined",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faCheck}),onClick:()=>C()}):(0,r.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-5)"},children:[(0,r.jsx)(o.default,{variant:"icon-plain",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faPen}),onClick:()=>g(!m)}),(0,r.jsx)(o.default,{variant:"icon-plain",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>S(!0)})]})]}),v&&(0,r.jsxs)("div",{className:"exercise-details",children:[e.serie&&e.serie.length>0&&e.serie.map(e=>(0,r.jsx)(p,{set:e,onUpdate:d,workoutId:h},e.id)),(0,r.jsx)(o.default,{variant:"outlined",onClick:E,leftIcon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faPlus}),children:"Nouvelle série"})]}),(0,r.jsx)(l,{isOpen:_,title:"Supprimer l'exercice",message:"Êtes-vous sûr de vouloir supprimer cet exercice ? Cette action est irréversible.",onConfirm:()=>{S(!1),I()},onCancel:()=>S(!1)})]})}function m(){let e=(0,i.useSearchParams)(),d=(0,i.useRouter)(),{setTitle:p}=(0,a.usePageTitle)(),[f,x]=(0,t.useState)(null),[m,g]=(0,t.useState)(!0),[v,j]=(0,t.useState)(null),[w,y]=(0,t.useState)(!1),[b,k]=(0,t.useState)(!1),_=e.get("workout"),S=(0,t.useCallback)(async()=>{if(_)try{g(!0);let e=await (0,s.getWorkoutById)(_);x(e),p(`S\xe9ance du ${new Date(e.date).toLocaleDateString("fr-FR")}`)}catch(e){j(e?.message||"Erreur lors du chargement")}finally{g(!1)}},[_,p]);(0,t.useEffect)(()=>{S()},[_,p,S]);let C=async()=>{try{await (0,s.deleteWorkout)(_),n.toast.success("Séance supprimée"),d.push("/")}catch(e){console.error("Erreur suppression séance:",e),n.toast.error("Erreur lors de la suppression de la séance")}};return m?(0,r.jsx)("div",{className:"content",children:"Chargement..."}):v||!f?(0,r.jsxs)("div",{className:"content",children:[(0,r.jsxs)("p",{children:["Erreur: ",v||"Séance non trouvée"]}),(0,r.jsx)(o.default,{variant:"outlined",onClick:()=>d.back(),children:"Retour"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("span",{className:"tag",children:f.categorie?.nom||"Séance"}),(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)(o.default,{variant:"icon-plain",icon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faEllipsisVertical}),onClick:()=>y(!w)}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>y(!1)}),(0,r.jsx)("div",{style:{position:"absolute",right:0,top:"100%",background:"var(--theme-tile-bg)",border:"1px solid var(--theme-tile-border)",borderRadius:"var(--radius-15)",padding:"var(--spacing-10)",minWidth:"200px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:(0,r.jsx)(o.default,{variant:"plain",fullWidth:!0,leftIcon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>{y(!1),k(!0)},style:{justifyContent:"flex-start",color:"var(--theme-text)"},children:"Supprimer"})})]})]})]}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[f.workout_line&&f.workout_line.length>0&&f.workout_line.map(e=>(0,r.jsx)(h,{id_category:f.id_category,exercise:e,isNew:null===e.id_exo,onExerciseUpdate:S,workoutId:_},e.id)),(0,r.jsx)(o.default,{variant:"filled",leftIcon:(0,r.jsx)(c.FontAwesomeIcon,{icon:u.faPlus}),onClick:()=>{(0,s.addExerciseToWorkout)(_).then(()=>{S(),n.toast.success("Exercice ajouté")}).catch(e=>{console.error("Erreur ajout exercice:",e),n.toast.error("Erreur lors de l'ajout de l'exercice")})},children:"Ajouter un exercice"})]}),(0,r.jsx)(l,{isOpen:b,title:"Supprimer la séance",message:"Êtes-vous sûr de vouloir supprimer cette séance ?",onConfirm:C,onCancel:()=>k(!1)})]})}e.s(["default",()=>m],44425)}]);