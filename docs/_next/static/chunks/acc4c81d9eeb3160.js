(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82564,e=>{"use strict";var t=e.i(43476);function r(){return(0,t.jsx)("div",{className:"loader-container",children:(0,t.jsxs)("div",{className:"loader-dots",children:[(0,t.jsx)("div",{className:"dot dot-1"}),(0,t.jsx)("div",{className:"dot dot-2"}),(0,t.jsx)("div",{className:"dot dot-3"})]})})}e.s(["default",()=>r])},1206,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(76525),i=e.i(49721),a=e.i(68757);let o=(0,r.forwardRef)(({label:e,error:o,fullWidth:n=!1,style:l,value:c,type:d,...u},p)=>{let[x,f]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),g=void 0!==c&&""!==c,v="password"===d;return(0,t.jsxs)("div",{className:["ui-input-container",n?"ui-input-container--full":""].join(" "),children:[e&&(0,t.jsx)("label",{className:"ui-input-label",children:e}),(0,t.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,t.jsx)("input",{ref:p,value:c,type:v&&h?"text":d,className:["ui-input",o?"ui-input--error":"",x?"ui-input--focus":"",g?"ui-input--filled":""].join(" "),style:{...l,paddingRight:v?"40px":void 0},onFocus:e=>{f(!0),u.onFocus?.(e)},onBlur:e=>{f(!1),u.onBlur?.(e)},...u}),v&&(0,t.jsx)(s.default,{type:"button",variant:"icon-plain",onClick:()=>m(!h),style:{position:"absolute",right:"5px",top:"50%",transform:"translateY(-50%)",zIndex:"100"},"aria-label":h?"Masquer le mot de passe":"Afficher le mot de passe",icon:(0,t.jsx)(i.FontAwesomeIcon,{icon:h?a.faEyeSlash:a.faEye})})]}),o&&(0,t.jsx)("span",{className:"ui-input-error",children:o})]})});o.displayName="Input",e.s(["default",0,o])},79390,e=>{"use strict";var t=e.i(17927);async function r(e,r,s){let{data:i,error:a}=await t.supabase.from("workout").select("*, categorie: id_category(id,nom,svg)").eq("id_user",e).order("date",{ascending:!1}).range(r,s);if(a)throw a;return i}async function s(e){let{data:r,error:s}=await t.supabase.from("workout").select(`
      *,
      categorie: id_category (
        id,
        nom
      ),
      workout_line (
        *,
        exercise: id_exo (
          id,
          nom
        ),
        serie (*,
          reps(*)
        )
      )
    `).eq("id",e).single();if(s)throw s;return r}async function i(e,r,s){let{data:i,error:a}=await t.supabase.from("workout").insert([{id_user:e,date:r,id_category:s}]).select().single();if(a)throw a;return i}async function a(e){let{data:r,error:s}=await t.supabase.from("workout_line").insert([{id_workout:e,id_exo:null}]).select().single();if(s)throw s;return r}async function o(e,r){let{data:s,error:i}=await t.supabase.from("workout_line").update({id_exo:r}).eq("id",e).select().single();if(i)throw i;return s}async function n(e,r){let{data:s,error:i}=await t.supabase.from("serie").insert([{id_workout_line:e,ordre:r}]).select().single();if(i)throw i;let{data:a,error:o}=await t.supabase.from("reps").insert([{id_serie:s.id,charge:0,qte:0}]).select().single();if(o)throw o;return s}async function l(e,r,s){let{data:i,error:a}=await t.supabase.from("reps").insert([{id_serie:e,charge:r,qte:s}]).select().single();if(a)throw a;return i}async function c(e,r,s){let{data:i,error:a}=await t.supabase.from("reps").update({charge:r,qte:s}).eq("id",e).select().single();if(a)throw a;return i}async function d(e){let{data:r,error:s}=await t.supabase.from("reps").delete().eq("id",e).select().single();if(s)throw s;return r}async function u(e){let{data:r,error:s}=await t.supabase.from("workout").delete().eq("id",e).select().single();if(s)throw s;return r}async function p(e){let{data:r,error:s}=await t.supabase.from("workout_line").delete().eq("id",e).select().single();if(s)throw s;return r}async function x(e){let{data:r,error:s}=await t.supabase.from("serie").delete().eq("id",e).select().single();if(s)throw s;return r}e.s(["addExerciseToWorkout",()=>a,"addRep",()=>l,"addSet",()=>n,"createWorkout",()=>i,"deleteExercise",()=>p,"deleteRep",()=>d,"deleteSerie",()=>x,"deleteWorkout",()=>u,"editRep",()=>c,"getWorkoutById",()=>s,"getWorkoutsPaginated",()=>r,"updateWorkoutLine",()=>o])},71120,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(49721),i=e.i(68757);function a({label:e,error:a,fullWidth:o=!1,options:n,placeholder:l,value:c,onChange:d,disabled:u=!1}){let[p,x]=(0,r.useState)(!1),[f,h]=(0,r.useState)(!1),m=(0,r.useRef)(null),g=n.find(e=>e.value===c);return(0,r.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&(x(!1),h(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.jsxs)("div",{className:["ui-input-container",o?"ui-input-container--full":""].join(" "),children:[e&&(0,t.jsx)("label",{className:"ui-input-label",children:e}),(0,t.jsxs)("div",{ref:m,style:{position:"relative"},children:[(0,t.jsxs)("div",{className:["ui-input ui-custom-select",a?"ui-input--error":"",f?"ui-input--focus":"",c?"ui-input--filled":"",u?"ui-custom-select--disabled":""].join(" "),onClick:e=>{e.stopPropagation(),u||x(!p)},onFocus:()=>h(!0),tabIndex:u?-1:0,style:{cursor:u?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[g?.icon&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:g.icon},style:{width:"20px",height:"20px",display:"flex",alignItems:"center",flexShrink:0},className:"custom-select-icon"}),(0,t.jsx)("span",{style:{flex:1},children:g?g.label:l||"Sélectionner..."}),(0,t.jsx)(s.FontAwesomeIcon,{icon:i.faChevronDown,style:{transition:"transform 0.2s",transform:p?"rotate(180deg)":"rotate(0deg)",flexShrink:0}})]}),p&&(0,t.jsx)("div",{className:"ui-custom-select-dropdown",onClick:e=>e.stopPropagation(),children:n.map(e=>(0,t.jsxs)("div",{className:["ui-custom-select-option",e.value===c?"ui-custom-select-option--selected":""].join(" "),onClick:t=>{var r;t.stopPropagation(),r=e.value,d?.(r),x(!1),h(!1)},style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.icon&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:e.icon},style:{width:"20px",height:"20px",display:"flex",alignItems:"center",flexShrink:0},className:"custom-select-icon"}),(0,t.jsx)("span",{children:e.label})]},e.value))})]}),a&&(0,t.jsx)("span",{className:"ui-input-error",children:a})]})}e.s(["default",()=>a])},35864,e=>{"use strict";var t=e.i(17927);async function r(e=null){if(!(await t.supabase.auth.getUser()).data.user)throw Error("Not authenticated");let s=t.supabase.from("exo").select(`
      id,
      nom,
      svg,
      exo_categorie!inner(
        categorie(
          id,
          nom
        )
      ),
      user_exo_preferences(hidden)
    `),{data:i,error:a}=await s;if(a)throw a;return(i?.filter(t=>!e||(t.exo_categorie?.flatMap(e=>e.categorie)??[]).some(t=>t?.id===e))??[]).map(e=>{let t=e.exo_categorie?.flatMap(e=>e.categorie)??[];return{id:e.id,nom:e.nom,svg:e.svg,hidden:!!e.user_exo_preferences?.[0]?.hidden,categories:t}}).filter(e=>!e.hidden)}async function s(e){return(await r(e)).map(e=>({value:String(e.id),label:e.nom,icon:e.svg||void 0}))}async function i(e,r){let s=(await t.supabase.auth.getUser()).data.user;if(!s)throw Error("Not authenticated");let{error:i}=await t.supabase.from("user_exo_preferences").upsert({id_user:s.id,id_exo:e,hidden:r},{onConflict:"id_user,id_exo"});if(i)throw i}e.s(["getExercisesForSelect",()=>s,"getExercisesWithPreferences",()=>r,"toggleExerciseHidden",()=>i])},44425,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),i=e.i(79390),a=e.i(60446),o=e.i(76525),n=e.i(46696);function l({isOpen:e,title:r,message:s,onConfirm:i,onCancel:a}){return e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9998},onClick:a}),(0,t.jsxs)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"var(--theme-tile-bg)",border:"1px solid var(--theme-tile-border)",borderRadius:"var(--radius-15)",padding:"var(--spacing-20)",minWidth:"300px",maxWidth:"90vw",zIndex:9999,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[(0,t.jsx)("h2",{style:{margin:"0 0 var(--spacing-15) 0",color:"var(--theme-title-text)"},children:r}),(0,t.jsx)("p",{style:{margin:"0 0 var(--spacing-20) 0",color:"var(--theme-text)"},children:s}),(0,t.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-10)",justifyContent:"flex-end"},children:[(0,t.jsx)(o.default,{variant:"outlined",onClick:a,children:"Annuler"}),(0,t.jsx)(o.default,{variant:"filled",onClick:i,children:"Confirmer"})]})]})]}):null}var c=e.i(82564),d=e.i(49721),u=e.i(68757),p=e.i(1206);function x({set:e,onUpdate:s,workoutId:a}){let[c,x]=(0,r.useState)(()=>{let t=localStorage.getItem(`workout_${a}_set_${e.id}_expanded`);return!!t&&JSON.parse(t)}),[f,h]=(0,r.useState)(!1),[m,g]=(0,r.useState)(()=>{let t={};return e.reps?.forEach(e=>{t[e.id]={charge:e.charge?.toString()||"0",qte:e.qte?.toString()||"0"}}),t}),v=(t,r,s)=>{g(e=>({...e,[t]:{...e[t],[r]:s}}));let a="charge"===r?parseFloat(s)||0:parseInt(s)||0;if(e.reps?.find(e=>e.id===t)){let e=m[t]||{charge:"0",qte:"0"},s="charge"===r?a:parseFloat(e.charge)||0,o="qte"===r?a:parseInt(e.qte)||0;(0,i.editRep)(t,s,o)}},j=async()=>{try{await (0,i.addRep)(e.id,0,0);let t=[...e.reps||[]];if(t.length>0){let e=t[t.length-1];g(t=>({...t,[e.id]:{charge:"0",qte:"0"}}))}s?.(),n.toast.success("Rep ajoutée")}catch(e){console.error("Erreur lors de l'ajout de la rep:",e),n.toast.error("Erreur lors de l'ajout de la rep")}},w=async e=>{try{await (0,i.deleteRep)(e),s?.(),n.toast.success("Rep supprimée")}catch(e){console.error("Erreur lors de la suppression de la rep:",e),n.toast.error("Erreur lors de la suppression de la rep")}},y=async()=>{try{await (0,i.deleteSerie)(e.id),s?.(),n.toast.success("Série supprimée")}catch(e){console.error("Erreur lors de la suppression de la série:",e),n.toast.error("Erreur lors de la suppression de la série")}};return(0,t.jsxs)("div",{className:"set-row",children:[(0,t.jsxs)("div",{className:"set-header",onClick:()=>{var t;x(t=!c),localStorage.setItem(`workout_${a}_set_${e.id}_expanded`,JSON.stringify(t))},children:[(0,t.jsxs)("div",{className:"set-title",children:[(0,t.jsx)(d.FontAwesomeIcon,{icon:c?u.faChevronDown:u.faChevronRight,style:{fontSize:"0.8rem"}}),(0,t.jsxs)("span",{children:["Série ",e.ordre]})]}),(0,t.jsx)(o.default,{variant:"icon-plain",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faTrash}),onClick:e=>{e.stopPropagation(),h(!0)}})]}),c&&(0,t.jsxs)("div",{className:"reps-container",children:[e.reps?.map(e=>{let r=m[e.id]||{charge:e.charge?.toString()||"0",qte:e.qte?.toString()||"0"};return(0,t.jsxs)("div",{className:"rep-row",children:[(0,t.jsx)(p.default,{label:"Charge (kg)",type:"number",value:r.charge,onChange:t=>v(e.id,"charge",t.target.value),fullWidth:!0}),(0,t.jsx)(p.default,{label:"Reps",type:"number",value:r.qte,onChange:t=>v(e.id,"qte",t.target.value),fullWidth:!0}),(0,t.jsx)(o.default,{variant:"icon-plain",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>w(e.id)})]},e.id)}),(0,t.jsx)(o.default,{variant:"plain",leftIcon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faPlus}),onClick:j,fullWidth:!0,playSound:!0,children:"Ajouter une rep"})]}),(0,t.jsx)(l,{isOpen:f,title:"Supprimer la série",message:"Êtes-vous sûr de vouloir supprimer cette série ? Cette action est irréversible.",onConfirm:()=>{h(!1),y()},onCancel:()=>h(!1)})]})}var f=e.i(71120),h=e.i(35864);function m({exercise:e,id_category:s,isNew:a,onExerciseUpdate:c,workoutId:p}){let[m,g]=(0,r.useState)(a),[v,j]=(0,r.useState)(()=>{let t=localStorage.getItem(`workout_${p}_exercise_${e.id}_expanded`);return!!t&&JSON.parse(t)}),[w,y]=(0,r.useState)([]),[b,k]=(0,r.useState)(e.exercise?.id||null),[S,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(0,h.getExercisesForSelect)(s).then(t=>{y(t),e.exercise?.id&&k(e.exercise.id),a&&g(!0)})},[a,s,e.exercise?.id]);let C=async()=>{try{await (0,i.updateWorkoutLine)(e.id,b),g(!1),c?.(),n.toast.success("Exercice mis à jour")}catch(e){console.error("Erreur lors de la mise à jour de l'exercice:",e),n.toast.error("Erreur lors de la mise à jour de l'exercice")}},I=async()=>{try{let t=Math.max(0,...e.serie?.map(e=>e.ordre)||[]);await (0,i.addSet)(e.id,t+1),c?.(),n.toast.success("Série ajoutée")}catch(e){console.error("Erreur lors de l'ajout de la série:",e),n.toast.error("Erreur lors de l'ajout de la série")}},E=async()=>{try{await (0,i.deleteExercise)(e.id),c?.(),n.toast.success("Exercice supprimé")}catch(e){console.error("Erreur lors de la suppression de l'exercice:",e),n.toast.error("Erreur lors de la suppression de l'exercice")}};return(0,t.jsxs)("div",{className:"exercise-card",children:[(0,t.jsxs)("div",{className:"exercise-header",children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-10)",flex:1,cursor:"pointer"},onClick:()=>{var t;j(t=!v),localStorage.setItem(`workout_${p}_exercise_${e.id}_expanded`,JSON.stringify(t))},children:[(0,t.jsx)(d.FontAwesomeIcon,{icon:v?u.faChevronDown:u.faChevronRight,style:{padding:"var(--spacing-10)",cursor:"pointer"}}),m?(0,t.jsx)(f.default,{options:[{label:"Choisir un exercice",value:""},...w],value:b||"",onChange:e=>k(e),fullWidth:!0}):(0,t.jsx)("span",{style:{flex:1},children:e.exercise?.nom||"Nouvel exercice"})]}),m?(0,t.jsx)(o.default,{variant:"icon-outlined",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faCheck}),onClick:()=>C()}):(0,t.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-5)"},children:[(0,t.jsx)(o.default,{variant:"icon-plain",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faPen}),onClick:()=>g(!m)}),(0,t.jsx)(o.default,{variant:"icon-plain",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>_(!0)})]})]}),v&&(0,t.jsxs)("div",{className:"exercise-details",children:[e.serie&&e.serie.length>0&&e.serie.map(e=>(0,t.jsx)(x,{set:e,onUpdate:c,workoutId:p},e.id)),(0,t.jsx)(o.default,{variant:"outlined",onClick:I,leftIcon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faPlus}),children:"Nouvelle série"})]}),(0,t.jsx)(l,{isOpen:S,title:"Supprimer l'exercice",message:"Êtes-vous sûr de vouloir supprimer cet exercice ? Cette action est irréversible.",onConfirm:()=>{_(!1),E()},onCancel:()=>_(!1)})]})}function g(){let e=(0,s.useSearchParams)(),p=(0,s.useRouter)(),{setTitle:x}=(0,a.usePageTitle)(),[f,h]=(0,r.useState)(null),[g,v]=(0,r.useState)(!0),[j,w]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),_=e.get("workout"),C=(0,r.useCallback)(async()=>{if(_)try{v(!0);let e=await (0,i.getWorkoutById)(_);h(e),x(`S\xe9ance du ${new Date(e.date).toLocaleDateString("fr-FR")}`)}catch(e){w(e?.message||"Erreur lors du chargement")}finally{v(!1)}},[_,x]);(0,r.useEffect)(()=>{C()},[_,x,C]);let I=async()=>{try{await (0,i.deleteWorkout)(_),n.toast.success("Séance supprimée"),p.push("/")}catch(e){console.error("Erreur suppression séance:",e),n.toast.error("Erreur lors de la suppression de la séance")}};return g?(0,t.jsx)("div",{className:"content",children:(0,t.jsx)(c.default,{})}):j||!f?(0,t.jsxs)("div",{className:"content",children:[(0,t.jsxs)("p",{children:["Erreur: ",j||"Séance non trouvée"]}),(0,t.jsx)(o.default,{variant:"outlined",onClick:()=>p.back(),children:"Retour"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{className:"tag",children:f.categorie?.nom||"Séance"}),(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)(o.default,{variant:"icon-plain",icon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faEllipsisVertical}),onClick:()=>b(!y)}),y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>b(!1)}),(0,t.jsx)("div",{style:{position:"absolute",right:0,top:"100%",background:"var(--theme-tile-bg)",border:"1px solid var(--theme-tile-border)",borderRadius:"var(--radius-15)",padding:"var(--spacing-10)",minWidth:"200px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:(0,t.jsx)(o.default,{variant:"plain",fullWidth:!0,leftIcon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faTrash}),onClick:()=>{b(!1),S(!0)},style:{justifyContent:"flex-start",color:"var(--theme-text)"},children:"Supprimer"})})]})]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[f.workout_line&&f.workout_line.length>0&&f.workout_line.map(e=>(0,t.jsx)(m,{id_category:f.id_category,exercise:e,isNew:null===e.id_exo,onExerciseUpdate:C,workoutId:_},e.id)),(0,t.jsx)(o.default,{variant:"filled",leftIcon:(0,t.jsx)(d.FontAwesomeIcon,{icon:u.faPlus}),onClick:()=>{(0,i.addExerciseToWorkout)(_).then(()=>{C(),n.toast.success("Exercice ajouté")}).catch(e=>{console.error("Erreur ajout exercice:",e),n.toast.error("Erreur lors de l'ajout de l'exercice")})},children:"Ajouter un exercice"})]}),(0,t.jsx)(l,{isOpen:k,title:"Supprimer la séance",message:"Êtes-vous sûr de vouloir supprimer cette séance ?",onConfirm:I,onCancel:()=>S(!1)})]})}e.s(["default",()=>g],44425)}]);