(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79390,e=>{"use strict";var t=e.i(17927);async function r(e,r,s){console.log("Fetching workouts for user",e,"from",r,"to",s);let{data:i,error:o}=await t.supabase.from("workout").select("*, categorie: id_category(id,nom,svg)").eq("id_user",e).order("date",{ascending:!1}).range(r,s);if(o)throw o;return i}async function s(e){console.log("Fetching workout with id",e);let{data:r,error:s}=await t.supabase.from("workout").select(`
      *,
      categorie: id_category (
        id,
        nom
      ),
      workout_line (
        *,
        exercise: id_exo (
          id,
          nom
        ),
        serie (*,
          reps(*)
        )
      )
    `).eq("id",e).single();if(s)throw s;return r}async function i(e,r,s){let{data:i,error:o}=await t.supabase.from("workout").insert([{id_user:e,date:r,id_category:s}]).select().single();if(o)throw o;return i}async function o(e){let{data:r,error:s}=await t.supabase.from("workout_line").insert([{id_workout:e,id_exo:null}]).select().single();if(s)throw s;return r}async function a(e,r){let{data:s,error:i}=await t.supabase.from("workout_line").update({id_exo:r}).eq("id",e).select().single();if(i)throw i;return s}async function n(e,r){let{data:s,error:i}=await t.supabase.from("serie").insert([{id_workout_line:e,ordre:r}]).select().single();if(i)throw i;let{data:o,error:a}=await t.supabase.from("reps").insert([{id_serie:s.id,charge:0,qte:0}]).select().single();if(a)throw a;return s}async function u(e,r,s){let{data:i,error:o}=await t.supabase.from("reps").insert([{id_serie:e,charge:r,qte:s}]).select().single();if(o)throw o;return i}async function l(e,r,s){let{data:i,error:o}=await t.supabase.from("reps").update({charge:r,qte:s}).eq("id",e).select().single();if(o)throw o;return i}async function c(e){let{data:r,error:s}=await t.supabase.from("reps").delete().eq("id",e).select().single();if(s)throw s;return r}async function d(e){let{data:r,error:s}=await t.supabase.from("workout").delete().eq("id",e).select().single();if(s)throw s;return r}async function f(e){let{data:r,error:s}=await t.supabase.from("workout_line").delete().eq("id",e).select().single();if(s)throw s;return r}async function w(e){let{data:r,error:s}=await t.supabase.from("serie").delete().eq("id",e).select().single();if(s)throw s;return r}e.s(["addExerciseToWorkout",()=>o,"addRep",()=>u,"addSet",()=>n,"createWorkout",()=>i,"deleteExercise",()=>f,"deleteRep",()=>c,"deleteSerie",()=>w,"deleteWorkout",()=>d,"editRep",()=>l,"getWorkoutById",()=>s,"getWorkoutsPaginated",()=>r,"updateWorkoutLine",()=>a])},31713,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(79390),i=e.i(60446),o=e.i(42365),a=e.i(76525),n=e.i(49721),u=e.i(68757),l=e.i(22016);let c=({workout:e})=>(0,t.jsxs)(l.default,{className:"workout tile",href:`/workout/?workout=${e.id}`,children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-2",children:["Séance du ",new Date(e.date).toLocaleDateString()]}),(0,t.jsx)("span",{className:"tag",children:e.categorie?.nom})]});var d=e.i(18566);function f(){let[e,l]=(0,r.useState)([]),[f,w]=(0,r.useState)(0),[g,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!0),[k,b]=(0,r.useState)(null),x=(0,d.useRouter)();(0,r.useEffect)(()=>{(0,o.getUser)().then(e=>{b(e?.data?.user?.id??null)})},[]);let{setTitle:y}=(0,i.usePageTitle)();(0,r.useEffect)(()=>{y("Dernières séances")},[y]);let _=(0,r.useRef)(null);return(0,r.useEffect)(()=>{k&&p&&(async()=>{h(!0);let e=10*f,t=await (0,s.getWorkoutsPaginated)(k,e,e+10-1);l(e=>0===f?t:[...e,...t]),m(10===t.length),h(!1)})()},[k,f,p]),(0,r.useEffect)(()=>{if(!p)return;let t=_.current;if(!t)return;let r=new IntersectionObserver(t=>{t[0].isIntersecting&&!g&&e.length>0&&w(e=>e+1)},{rootMargin:"200px",threshold:0});return r.observe(t),()=>r.disconnect()},[_,g,p,e.length]),(0,t.jsxs)("div",{children:[e.map(e=>(0,t.jsx)(c,{workout:e},e.id)),p&&(0,t.jsx)("div",{ref:_,className:"p-4 text-center",children:"Chargement..."}),(0,t.jsx)(a.default,{variant:"icon-filled",size:"lg",className:"fab-button","aria-label":"Ajouter une séance",icon:(0,t.jsx)(n.FontAwesomeIcon,{icon:u.faPlus}),onClick:()=>{x.push("workout/new")}})]})}e.s(["default",()=>f],31713)}]);